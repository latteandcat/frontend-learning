<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      class DoubleLinkNode {
        constructor(value, prev, next) {
          this.value = value ?? 0
          this.prev = prev ?? null
          this.next = next ?? null
        }
      }

      class DoubleLinkList {
        constructor() {
          this._head = null
        }

        isEmpty() {
          return this._head === null
        }

        get length() {
          if (this.isEmpty()) return 0
          let cur = this._head
          let count = 0
          while (cur !== null) {
            count += 1
            cur = cur.next
          }
          return count
        }

        travel() {
          if (this.isEmpty()) return
          let cur = this._head
          while (cur !== null) {
            console.log(cur.value)
            cur = cur.next
          }
        }

        addNode(nodeValue) {
          const newNode = new DoubleLinkNode(nodeValue)
          if (this.isEmpty()) {
            this._head = newNode
          } else {
            newNode.next = this._head
            this._head.prev = newNode
            this._head = newNode
          }
        }

        appendNode(nodeValue) {
          const newNode = new DoubleLinkNode(nodeValue)
          if (this.isEmpty()) {
            this._head = newNode
          } else {
            let cur = this._head
            while (cur.next !== null) {
              cur = cur.next
            }
            cur.next = newNode
            newNode.prev = cur
          }
        }

        insertNode(insertPos, nodeValue) {
          if (this.isEmpty() || insertPos <=0) {
            this.addNode(nodeValue)
          } else if (insertPos >= this.length) {
            this.appendNode(nodeValue)
          } else {
            const newNode = new DoubleLinkNode(nodeValue)
            let count = 0
            let pre = this._head
            // 从第1个节点开始后移 pos-1 次找到第 pos 个节点
            while (count < insertPos - 1) {
              count += 1
              pre = pre.next
            }
            pre.next.prev = newNode
            newNode.next = pre.next
            pre.next = newNode
            newNode.prev = pre
          }
        }

        removeNode(nodeValue) {
          let cur = this._head
          while (cur !== null) {
            if (cur.value === nodeValue) {
              if (cur === this._head) {
                // 若删除的节点为头节点
                this._head = cur.next
                cur.next.prev = null
              } else if (cur.next === null) {
                // 若删除的节点为尾节点
                cur.prev.next = null
              } else {
                // 若删除的节点为中间节点
                cur.next.prev = cur.prev
                cur.prev.next = cur.next
              }
              break
            } else {
              cur = cur.next
            }
          }
        }

        searchNode(nodeValue) {
          let cur = this._head
          while (cur !== null) {
            if (cur.value === nodeValue) {
              return true
            } else {
              cur = cur.next
            }
          }
          return false
        }
      }

      const d1 = new DoubleLinkList()
      console.log("empty:", d1.isEmpty())
      console.log("length:", d1.length)
      d1.addNode(10)
      d1.addNode(5)
      d1.appendNode(20)
      d1.appendNode(30)
      d1.insertNode(2, 15)
      d1.insertNode(4, 25)
      d1.insertNode(6, 35)
      console.log("search5: ", d1.searchNode(5))
      d1.removeNode(5)
      d1.removeNode(15)
      d1.removeNode(25)
      d1.removeNode(35)
      console.log("search5: ", d1.searchNode(5))
      console.log("empty:", d1.isEmpty())
      console.log("length:", d1.length)
      console.log("d1:", d1);
      console.log("travel start");
      d1.travel()
      console.log("travel end");
    </script>
  </body>
</html>
